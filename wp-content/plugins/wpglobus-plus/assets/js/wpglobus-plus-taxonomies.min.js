jQuery(document).ready(function(l){"use strict";var u={postType:"",spinnerClass:".spinner",dialogBeforeOpen:function(o){l(".wpglobus-button-save").css({visibility:"hidden"})},dialogClose:function(o){l(".wpglobus-button-save").css({visibility:""})},setPostType:function(){if(void 0!==WPGlobusPlusTaxonomies.$_GET["post-type"]){var o=WPGlobusPlusTaxonomies.$_GET["post-type"];if(0==l("#tabs-taxonomies li.tab-post-type-"+o).length){u.postType="post";var t="admin.php"+location.search.replace("post-type="+o,"post-type=post");history.pushState({},"",t)}else u.postType=o}else u.postType="post"},getPostType:function(){return u.postType},init:function(){void 0!==WPGlobusPlusTaxonomies.pagenow&&"options-permalink.php"==WPGlobusPlusTaxonomies.pagenow&&u.initPermalinkPage(),"taxonomies"==WPGlobusPlus.tab&&(l(WPGlobusPlusTaxonomies.setContentId).html(WPGlobusPlusTaxonomies.contentHtml),u.setPostType(),this.start(),this.attachListeners())},initPermalinkPage:function(){},tabActivate:function(o,t,s){s=s||!1;var a=l(t.oldTab).data("post-type")||!1,e=l(t.newTab).data("post-type")||!1;if(e=e||u.getPostType(),l("#tabs-taxonomies li").css({"font-weight":""}),l("#tabs-taxonomies li.tab-post-type-"+e).css({"font-weight":"bold"}),!s){var n=location.search;if(-1==n.indexOf("&post-type=")){var i="admin.php"+n+"&post-type="+e;history.pushState({},"",i)}else if(a){i="admin.php"+(n=n.replace("post-type="+a,"post-type="+e));history.pushState({},"",i)}}},start:function(){l("#tabs-taxonomies").tabs({create:function(o,t){u.tabActivate(o,t,!0)},activate:function(o,t){u.tabActivate(o,t)}}).addClass("ui-tabs-vertical ui-helper-clearfix"),l("#tabs-taxonomies li").removeClass("ui-corner-top").addClass("ui-corner-left"),setTimeout(function(){if(l(".wpglobus-plus-section").removeClass("one-col"),l("#post-type-"+u.postType).click(),""==location.hash)l(".wpglobus-plus-taxonomies-terms-box").addClass("hidden");else if("post"!=u.getPostType()){var o=l("body"),t=l(location.hash);1==t.length&&o.animate({scrollTop:t.offset().top-o.offset().top+o.scrollTop()})}},300),u.setTooltip()},setTooltip:function(){l(".wpglobus-plus-taxonomies-help").tooltip({position:{my:"center bottom-20",at:"center top",using:function(o,t){l(this).css(o),l("<div>").addClass("arrow").addClass(t.vertical).addClass(t.horizontal).appendTo(this)}}})},attachListeners:function(){l(document).on("keyup",".wpglobus-plus-taxonomy-field",function(o){var t=l(this),s=t.val();s.match(/\s/);null!==s.match(/\s/)&&t.val(s.replace(/\s/g,"-"))}),l(document).on("change",".wpglobus-plus-taxonomy-field",function(o){var t=l(this),s=t.data("source-id"),a=t.data("language"),e=t.val();a!=WPGlobusCoreData.default_language&&(""==e&&(e=t.data("slug-default"),t.val(e)),l(s).val(WPGlobusCore.getString(l(s).val(),e,a)))}),l(document).on("click",".wpglobus-plus-taxonomies-toggle",function(o){var t=l(this);l("#wpglobus-plus-taxonomies-"+t.data("taxonomy")+"-terms-box").hasClass("hidden")?(l(".wpglobus-plus-taxonomies-terms-box").addClass("hidden"),l("#wpglobus-plus-taxonomies-"+t.data("taxonomy")+"-terms-box").removeClass("hidden")):l(".wpglobus-plus-taxonomies-terms-box").addClass("hidden")}),l(document).on("click",".wpglobus-plus-taxonomies-hide-empty-terms",function(o){var e=l(this);e.prop("checked")?l("#wpglobus-plus-taxonomies-"+e.data("taxonomy")+"-terms-box .wpglobus-taxonomy-term-source").each(function(o,t){var s=l(t);if(""==s.val()){var a=s.data("term-id");l("#wpglobus-plus-taxonomies-"+e.data("taxonomy")+"-terms-box #taxonomy-term-"+a).addClass("hidden")}}):l("#wpglobus-plus-taxonomies-"+e.data("taxonomy")+"-terms-box .wpglobus-plus-taxonomies-term").removeClass("hidden")}),l(document).on("dblclick",".post-type-tab",function(o){l(".wpglobus-taxonomy-source").toggleClass("hidden"),l(".wpglobus-taxonomy-term-source").toggleClass("hidden")}),l(document).on("click",".post-type-save",function(o){var t=l(this),n={post_type:{},taxonomy:{}};l(t.data("tab-id")+" .wpglobus-taxonomy-source").each(function(o,t){var s=l(t),a=s.data("post-type");void 0!==a&&(n.post_type[a]={},n.post_type[a]=s.val());var e=s.data("taxonomy");void 0!==e&&(n.taxonomy[e]={},n.taxonomy[e].slug=s.val())}),l(t.data("tab-id")+" .wpglobus-taxonomy-term-source").each(function(o,t){var s=l(t),a=s.data("taxonomy"),e=(s.data("term-slug"),"term_id_"+s.data("term-id"));void 0!==n.taxonomy[a]&&(void 0===n.taxonomy[a].term_slug&&(n.taxonomy[a].term_slug={}),void 0===n.taxonomy[a].term_slug[e]&&(n.taxonomy[a].term_slug[e]={}),n.taxonomy[a].term_slug[e]=s.val())}),u.ajax({action:"taxonomies-save",module:WPGlobusPlusTaxonomies.module,post_type:t.data("post-type"),data:n},u.beforeSend).done(function(o){}).fail(function(o){}).always(function(o,t){l(u.spinnerClass).css({visibility:"hidden"})})}),void 0!==WPGlobusPlusTaxonomies.$_GET.section&&"debug"==WPGlobusPlusTaxonomies.$_GET.section&&l(document).on("click",".wpglobus-plus-taxonomies-title",function(o){var t=l(this).data("id");l(".wpglobus-plus-taxonomies-debug-data-"+t).hasClass("hidden")?(l(".wpglobus-plus-taxonomies-debug-data").addClass("hidden"),l(".wpglobus-plus-taxonomies-debug-data-"+t).removeClass("hidden")):l(".wpglobus-plus-taxonomies-debug-data").addClass("hidden")}),void 0!==WPGlobusPlusTaxonomies.$_GET.section&&"rewrite_rules"==WPGlobusPlusTaxonomies.$_GET.section&&l(document).on("click",".wpglobus-plus-taxonomies-title",function(o){var t=l(this).data("id");l(".wpglobus-plus-taxonomies-rewrite_rules-data-"+t).hasClass("hidden")?(l(".wpglobus-plus-taxonomies-rewrite_rules-data").addClass("hidden"),l(".wpglobus-plus-taxonomies-rewrite_rules-data-"+t).removeClass("hidden")):l(".wpglobus-plus-taxonomies-rewrite_rules-data").addClass("hidden")})},beforeSend:function(){l(u.spinnerClass).css({visibility:"visible"})},ajax:function(o,t){return l.ajax({beforeSend:function(){void 0!==t&&t()},type:"POST",url:ajaxurl,data:{action:WPGlobusPlusTaxonomies.process_ajax,order:o},dataType:"json"})}};WPGlobusPlusTaxonomies=l.extend({},WPGlobusPlusTaxonomies,u),WPGlobusPlusTaxonomies.init()});