jQuery(document).ready(function(l){"use strict";var o={startX:0,startY:0,endX:0,endY:0,option:{tableLanguage:WPGlobusCoreData.language},selector:['<div class="wpglobus-selector">','<span class="language">{{language}}</span>','<div class="wpglobus-language-box">',"<ul>","{{language_list}}","</ul>","</div>","</div>"].join(""),init:function(e){o.option=l.extend(o.option,e),"tablepress-all-tables"==WPGlobusPlusTablePress.action?o.setAllTables():(o.addSelector(),o.setTable(!0),o.addElements(),o.addListeners())},setAllTables:function(){l([".tablepress-all-tables .column-table_name a",".tablepress-all-tables .column-table_description"]).each(function(e,a){l(a).each(function(e,a){var t=l(this);t.text(WPGlobusCore.TextFilter(t.text(),WPGlobusCoreData.language))})})},setMenuItems:function(){l(".wpglobus-selector .language").text(WPGlobusCoreData.en_language_name[o.option.tableLanguage]),l(".wpglobus-language-box ul").html(o.getMenuItems()),o.addMenuListeners()},getMenuItems:function(){var t="";return l.each(WPGlobusCoreData.enabled_languages,function(e,a){a!=o.option.tableLanguage&&(t+='<li><a href="" onclick="return false;" class="item" data-language="'+a+'">'+WPGlobusCoreData.en_language_name[a]+"</a></li>")}),t},addSelector:function(){o.selector=o.selector.replace("{{language}}",WPGlobusCoreData.en_language_name[WPGlobusCoreData.language]),o.selector=o.selector.replace("{{language_list}}",o.getMenuItems),l("#tablepress_edit-table-data .handlediv").before(o.selector)},setTable:function(s){l("#edit-form-body textarea").each(function(e,a){var t,n=l(this);s?(t=n.val(),n.attr("data-wpglobus-source",t)):t=n.data("wpglobus-source"),n.val(WPGlobusCore.TextFilter(t,o.option.tableLanguage,"RETURN_EMPTY"))})},addTableListeners:function(){l("#edit-form-body textarea").each(function(e,a){var t=l(this);t.off("change"),t.on("change",function(e){var a=l(this);a.data("wpglobus-source",WPGlobusCore.getString(a.data("wpglobus-source"),a.val(),o.option.tableLanguage))})})},addAppendListeners:function(){var e=["#rows-append","#columns-append","#rows-duplicate","#columns-duplicate","#rows-insert","#columns-insert"].join(",");l(e).on("click",function(e){l("#edit-form-body textarea").each(function(e,a){var t=l(this);null==t.data("wpglobus-source")&&t.attr("data-wpglobus-source","")}),o.addTableListeners()})},addListeners:function(){o.addTableListeners(),l(".save-changes-button").on("mouseenter",function(e){l("#edit-form-body textarea").each(function(e,a){var t=l(this);"undefined"!=t.data("wpglobus-source")&&t.val(t.data("wpglobus-source"))});var a=l(this);o.startX=a.offset().left,o.startY=a.offset().top,o.endX=o.startX+a.width(),o.endY=o.startY+a.height()}).on("mouseleave",function(e){o.setTable(!1)}),l(document).ajaxComplete(function(e,a,t){0<=t.data.indexOf("action=tablepress_save_table&")&&l(document).one("mousemove",function(e){(e.pageX<o.startX-5||e.pageX>o.endX+20||e.pageY<o.startY||e.pageY>o.endY+5)&&o.setTable(!1)})}),l(".wpglobus-selector").on("mouseenter",function(e){l(".wpglobus-language-box").css({display:"block"})}).on("mouseleave",function(e){l(".wpglobus-language-box").css({display:"none"})}),o.addMenuListeners(),o.addAppendListeners()},addMenuListeners:function(){l(".wpglobus-selector .item").on("click",function(e){l(".wpglobus-language-box").css({display:"none"}),o.option.tableLanguage=l(this).data("language"),o.setTable(!1),o.setMenuItems()})},addElements:function(){WPGlobusDialogApp.addElement({id:"table-name",dialogTitle:"Edit Table name",sbTitle:"Click for edit",style:"width:95%;float:left;"}),WPGlobusDialogApp.addElement({id:"table-description",dialogTitle:"Edit Table description",sbTitle:"Click for edit"})}};WPGlobusPlusTablePress=l.extend({},WPGlobusPlusTablePress,o),WPGlobusPlusTablePress.init()});